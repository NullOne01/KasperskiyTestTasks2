using System.IO;

namespace scan_service.Data.MalwareTypes
{
    public class MalwareBadLine : MalwareType
    {
        private readonly string _malwareLine;

        public MalwareBadLine(string fileExtension, string malwareLine) : base(fileExtension)
        {
            _malwareLine = malwareLine;
        }

        public override bool IsFileMalware(FileInfo fileInfo)
        {
            using var fileStream = File.OpenRead(fileInfo.FullName);
            using var streamReader = new StreamReader(fileStream);
            string line;
            while ((line = streamReader.ReadLine()) != null)
            {
                if (DoLineMatch(line))
                {
                    return true;
                }
            }

            return false;
        }

        public bool DoLineMatch(string line)
        {
            return line == _malwareLine;
        }
    }
}